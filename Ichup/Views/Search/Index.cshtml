
@model PagedList.IPagedList<Ichup.Controllers.SearchController.searchitem>
@using PagedList.Mvc; 
@{
    ViewBag.Title = "Kết quả tìm kiếm";
    Layout = "~/Views/Shared/_Layout.cshtml";
    string allFilter = ViewBag.f0 + ViewBag.f1 + ViewBag.f2 + ViewBag.f3 + ViewBag.f4 + ViewBag.f5;
    int typeUser = 0;
    typeUser=int.Parse(ViewBag.typeUser.ToString());
    
}
<section class="search-index-08">
        <div class="container">


            <div class="col-md-12">
                <div class="col-md-2 menu-left">

                    <button type="button" id="dropdown-menu-left" class="btn btn-default dropdown-toggle dropdown-menu-left" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Tìm kiếm nâng cao<span class="fa fa-angle-down"></span> <span class="sr-only">Toggle Dropdown</span> </button>
                    <div id="ul-dropdown-menu-left" class="ul-dropdown-menu-left">
                        <div class="panel-group" id="" role="tablist" aria-multiselectable="true">
                            <div class="panel panel-menu-left">
                                <div class="panel-heading" role="tab" id="heading1">
                                    <h4 class="panel-title">
                                        <a role="button" data-toggle="collapse" data-parent="" href="#collapse1" aria-expanded="true" aria-controls="collapse1">
                                            Giá bán
                                            <i class="fa pull-right"></i>
                                        </a>

                                    </h4>
                                </div>
                                <div id="collapse1" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="heading1">
                                    <div class="panel-body">
                                        @Html.Raw(@Ichup.Config.getF0Ck(@ViewBag.f0))   
                                    </div>
                                </div>
                            </div>
                            <div class="panel panel-menu-left">
                                <div class="panel-heading" role="tab" id="heading1">
                                    <h4 class="panel-title">
                                        <a role="button" data-toggle="collapse" data-parent="" href="#collapse1" aria-expanded="true" aria-controls="collapse1">
                                            Tất cả các loại
                                            <i class="fa pull-right"></i>
                                        </a>

                                    </h4>
                                </div>
                                <div id="collapse1" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="heading1">
                                    <div class="panel-body">
                                        @Html.Raw(@Ichup.Config.getF1Ck(@ViewBag.f1))   
                                    </div>
                                </div>
                            </div>
                            <div class="panel panel-menu-left">
                                <div class="panel-heading" role="tab" id="heading2">
                                    <h4 class="panel-title">
                                        <a role="button" data-toggle="collapse" data-parent="" href="#collapse2" aria-expanded="false" aria-controls="collapse2">
                                            Kiểu ảnh
                                            <i class="fa pull-right"></i>
                                        </a>
                                    </h4>
                                </div>
                                <div id="collapse2" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="heading2">
                                    <div class="panel-body">
                                       @Html.Raw(@Ichup.Config.getF2Ck(@ViewBag.f2)) 
                                    </div>
                                </div>
                            </div>
                            <div class="panel panel-menu-left">
                                <div class="panel-heading" role="tab" id="heading3">
                                    <h4 class="panel-title">
                                        <a role="button" data-toggle="collapse" data-parent="" href="#collapse3" aria-expanded="false" aria-controls="collapse3">
                                            Danh mục
                                            <i class="fa pull-right"></i>
                                        </a>
                                    </h4>
                                </div>
                                <div id="collapse3" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="heading3">
                                    <div class="panel-body">
                                        @Html.Raw(@Ichup.Config.getF3Ck(@ViewBag.f3)) 
                                    </div>
                                </div>
                            </div>
                            <div class="panel panel-menu-left">
                                <div class="panel-heading" role="tab" id="heading4">
                                    <h4 class="panel-title">
                                        <a role="button" data-toggle="collapse" data-parent="" href="#collapse4" aria-expanded="false" aria-controls="collapse4">
                                            Người
                                            <i class="fa pull-right"></i>
                                        </a>
                                    </h4>
                                </div>
                                <div id="collapse4" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="heading4">
                                    <div class="panel-body">
                                        @Html.Raw(@Ichup.Config.getF4Ck(@ViewBag.f4)) 
                                    </div>
                                </div>
                            </div>
                            <div class="panel panel-menu-left">
                                <div class="panel-heading" role="tab" id="heading5">
                                    <h4 class="panel-title">
                                        <a role="button" data-toggle="collapse" data-parent="" href="#collapse5" aria-expanded="false" aria-controls="collapse5">
                                            Góc chụp
                                            <i class="fa pull-right"></i>
                                        </a>
                                    </h4>
                                </div>
                                <div id="collapse5" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="heading5">
                                    <div class="panel-body">
                                        @Html.Raw(@Ichup.Config.getF5Ck(@ViewBag.f5))
                                    </div>
                                </div>
                            </div>
                            <div class="panel panel-menu-left">
                                <div class="panel-heading" role="tab" id="heading6">
                                    <h4 class="panel-title">
                                        <a role="button" data-toggle="collapse" data-parent="" href="#collapse6" aria-expanded="false" aria-controls="collapse6">
                                            Địa điểm
                                            <i class="fa pull-right"></i>
                                        </a>
                                    </h4>
                                </div>
                                <div id="collapse6" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="heading6">
                                    <div class="panel-body">
                                        <input type="text" id="address" name="address" value="@ViewBag.address">
                                    </div>
                                </div>
                            </div>

                            
                        </div>

                        @*<div class="btn1-menu-left">Lorem ipsum dolor <i class="fa fa-angle-down pull-right"></i></div>*@

                        <div class="btn2-menu-left">Xóa bộ lọc</div>
                    </div>




                </div>

                <div class="col-md-8" style="padding:0">

                    <div class="input-group">

                        <div class="input-group-btn">
                            <button id="dropdown-option-index" type="button" class="btn btn-default dropdown-toggle dropdown-option-index" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">Tất cả các loại <span class="fa fa-angle-down"></span> <span class="sr-only">Toggle Dropdown</span> </button>
                            <div id="ul-dropdown-option-index" class="ul-dropdown-option-index">
                                <div class="item-checkbox">
                                    <input type="checkbox" name="checkbox30" id="checkbox30" checked class="css-checkbox">Ảnh số
                                </div>
                                <div class="item-checkbox">
                                    <input type="checkbox" name="checkbox31" id="checkbox31" class="css-checkbox">Vector
                                </div>
                                <div class="item-checkbox">
                                    <input type="checkbox" name="checkbox32" id="checkbox32" class="css-checkbox">Video
                                </div>
                            </div>
                        </div>
                        <div class="group-input-search-index">
                            <input id="input-search-index" type="text" placeholder="Nhập từ khóa" value="@ViewBag.keyword" class="form-control input-search-index" aria-label="Gõ từ khóa">
                            
                        </div>

                        <div class="input-group-btn">
                            <button type="button" class="btn btn-default button-search-index" onclick="search();"><i class="fa fa-search"></i></button>

                        </div>
                    </div>

                </div>
            </div>






        </div>

    </section>




    <section class="gallery-index-08">

        <div class="container">
            <div class="row">


                <div id="gallery-respon" class="col-md-12">
                    <div class="col-xs-12 col-md-6 tag-top">
                        <div class="title-tag"><h4 class="title">Tìm thấy (@Model.TotalItemCount) - <span>ảnh</span></h4></div>
                        <div class="span4">
                            <div class="portfolio-controllers-container">
                              <p class="pull-left sort-title">Sắp xếp &nbsp;</p>
                              <div class="btn-group">
                                <button class="btn btn-large" id="order">Phù hợp nhất</button>
                                <button class="btn btn-large dropdown-toggle" data-toggle="dropdown">
                                  <span class="caret"></span>
                                </button>
                                <ul class="dropdown-menu" id="filters">
                                  <!-- dropdown menu links -->
                                  <li><a onclick="setorder('RANK','Desc');"   id="order1">Phù hợp nhất</a></li>
                                  <li><a onclick="setorder('id','Desc');" id="order2">Mới nhất</a></li>
                                  <li><a onclick="setorder('id','Asc');" id="order3">Cũ nhất</a></li>
                                  <li><a onclick="setorder('total_views','Desc');" id="order4">Xem nhiều nhất</a></li>
                                </ul>
                              </div> <!-- end btn-group -->
                            </div> <!-- end portfolio-controllers-container -->
                          </div> <!-- end span4 -->
                        <div class="list-tag">
                            @*<span class="label label-default">Lorem X</span>
                            <span class="label label-default">Lorem X</span>
                            <span class="label label-default">Lorem ipsum </span>
                            <span class="label">Lorem X</span>*@
                            @*<section class="refinements-summary">*@
                                @Html.Raw(Ichup.Config.tags(allFilter))
                                @if (allFilter != "" && allFilter != null)
                                {<span style="cursor:pointer;" onclick="removeAllFilter();" class="label label-default">Xóa bộ lọc X</span>}
                            @*</section>*@
                        </div>
                    </div>
                    <div class="col-xs-12 col-md-6 pagination-top">
                        <nav class="nav-pagination pull-right">
                            <ul class="pagination">
                                <li><span href="#" aria-label="Previous">Trang</span></li>
                                <li><a href="#">1</a></li>
                                <li><span href="#">trong số 325</span></li>

                                <li><a href="#" class="bg-arrow">›</a></li>
                                <li><a href="#" class="bg-arrow" aria-label="Next"><span aria-hidden="true">»</span></a></li>
                            </ul>
                        </nav>
                    </div>


                    <div class="clearfix"></div>

                    <div class="list-gallery-index-08 row">
                         @Html.Partial("~/Views/_displayimage.cshtml")
                        @foreach (var item in Model) { 
                        <div class="col-xs-12 col-sm-6 col-md-3 gallery-item">
                            <div class="gallery-item-thumb img-resize"><a href="#" onclick="imagepage(@item.id)"><img src="@item.link_thumbail_small" alt="#"></a></div>
                        </div>
                        }

                    </div>

                    <div class="clearfix"></div>
                    <nav class="nav-pagination pull-right">
                        <ul class="pagination">
                            <li><span href="#" aria-label="Previous">Trang</span></li>
                            @for (int i = 1; i <= Model.PageCount; i++)
                                    {
                                        <li ><a onclick="setpage(@i);" style="cursor:pointer;">@i</a></li>
                                    }
                            <li><span href="#">trong số @Model.PageCount</span></li>

                            <li><a href="#" class="bg-arrow">›</a></li>
                            <li><a href="#" class="bg-arrow" aria-label="Next"><span aria-hidden="true">»</span></a></li>
                        </ul>
                    </nav>
                </div>

            </div>
        </div>
        <!--<div class="bg-wrapper-stripes">
            <div class="container container-end">

            </div>
        </div>-->
    </section><!-- end news-index-->

  
    <!-- ============================  Search Results Ends ============================ -->
<script>
    var pg=@ViewBag.page;
    var order="@ViewBag.order";
    var to="@ViewBag.to";
    var address="@ViewBag.address";
    if (order.toString().indexOf("RANK")>=0){
        $("#order1").addClass("selected");
        $("#order").html("Phù hợp nhất");
    }
    if (order.toString().indexOf("id")>=0 && to.toString().indexOf("Desc")>=0){
        $("#order2").addClass("selected");
        $("#order").html("Mới nhất");
    }
    if (order.toString().indexOf("id")>=0 && to.toString().indexOf("Asc")>=0){
        $("#order3").addClass("selected");
        $("#order").html("Cũ nhất");
    }
    if (order.toString().indexOf("total_views")>=0){
        $("#order4").addClass("selected");
        $("#order").html("Xem nhiều nhất");
    }
    if ("@ViewBag.f0"!=""){opendv(0);}
    if ("@ViewBag.f1"!=""){opendv(1);}
    if ("@ViewBag.f2"!=""){opendv(2);}
    if ("@ViewBag.f3"!=""){opendv(3);}
    if ("@ViewBag.f4"!=""){opendv(4);}
    if ("@ViewBag.f5"!=""){opendv(5);}
    function setorder(field,t) {
        order=field;
        to=t;
        pg=1;
        search();
    }
    function setpage(page) {
        pg=page;
        search();
    }
    function search() {
        var url = "/Search?";
        var k = $("#input-search-index").val();
        if (k == "") {
            return;
        }
        var f0="";
        var f1="";
        var f2="";
        var f3="";
        var f4="";
        var f5="";
        for (var i = 1; i <= 2; i++) {
            if (document.getElementById("f-0_" + i).checked){
                f0 += document.getElementById("f-0_" + i).value + ",";
            }
        }
        for (var i = 1; i <= 3; i++) {
            if (document.getElementById("f-1_" + i).checked){
                f1 += document.getElementById("f-1_" + i).value + ",";
            }
        }
        for (var i = 1; i <= 3; i++) {
            if (document.getElementById("f-2_" + i).checked){
                f2 += document.getElementById("f-2_" + i).value + ",";
            }
        }
        for (var i = 1; i <= 30; i++) {
            if (document.getElementById("f-3_" + i) && document.getElementById("f-3_" + i).checked) {
                f3 += document.getElementById("f-3_" + i).value + ",";
            }
        }
        for (var i = 1; i <= 9; i++) {
            if (document.getElementById("f-4_" + i) && document.getElementById("f-4_" + i).checked) {
                f4 += document.getElementById("f-4_" + i).value + ",";
            }
        }
        for (var i = 1; i <= 5; i++) {
            if (document.getElementById("f-5_" + i) && document.getElementById("f-5_" + i).checked) {
                f5 += document.getElementById("f-5_" + i).value + ",";
            }
        }
        url += "k=" + k + "&f0=" + f0 +"&f1=" + f1 + "&f2=" + f2 + "&f3=" + f3 + "&f4=" + f4 + "&f5=" + f5+"&address="+address+"&order="+order+"&to="+to+"&pg="+pg;
        window.location.href = url;
    }
    var currentId = -1;
    function removeFilter(key){
        for (var i = 1; i <= 2; i++) {
            if (document.getElementById("f-0_" + i).checked && document.getElementById("f-0_" + i).value==key){
                document.getElementById("f-0_" + i).checked=false;
                search();
                break;
            }
        }
        for (var i = 1; i <= 3; i++) {
            if (document.getElementById("f-1_" + i).checked && document.getElementById("f-1_" + i).value==key){
                document.getElementById("f-1_" + i).checked=false;
                search();
                break;
            }
        }
        for (var i = 1; i <= 3; i++) {
            if (document.getElementById("f-2_" + i).checked && document.getElementById("f-2_" + i).value==key){
                document.getElementById("f-2_" + i).checked=false;
                search();
                break;
            }
        }
        for (var i = 1; i <= 30; i++) {
            if (document.getElementById("f-3_" + i).checked && document.getElementById("f-3_" + i).value==key){
                document.getElementById("f-3_" + i).checked=false;
                search();
                break;
            }
        }
        for (var i = 1; i <= 9; i++) {
            if (document.getElementById("f-4_" + i).checked && document.getElementById("f-4_" + i).value==key){
                document.getElementById("f-4_" + i).checked=false;
                search();
                break;
            }
        }
        for (var i = 1; i <= 5; i++) {
            if (document.getElementById("f-5_" + i).checked && document.getElementById("f-5_" + i).value==key){
                document.getElementById("f-5_" + i).checked=false;
                search();
                break;
            }
        }
    }
    function removeAllFilter(){
        $(':checkbox').each(function(i,item){
            $(item).attr('checked', false);
        });
        search();
    }
    
</script>